<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Digital Wallet Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:'Poppins',sans-serif;
}
body{
  background:#4a5670;
  color:#fff;
  min-height:100vh;
}
/* Logo text layout */
.logo{
    display: flex;
    align-items: center;
    gap: 10px;
}

/* Logo image size */
.logo img{
    width: 42px;
    height: 42px;
    border-radius: 50%;
}

/* Secure Digital Wallet (BIG) */
.logo b{
    font-size: 17px;
    font-weight: 800;
    
    display: block;
    opacity: 0.65;
    /* line-height: 1.2; */
}

/* APP REVIEWS WORLD (SMALL) */
.logo small{
    font-size: 5px;
    font-weight: 800;
    
    opacity: 0.65;
    /* letter-spacing: 2px; */
    display: block;
}
/* Balance Card */
.card{
  background:#1e293b;
  padding:20px;
  border-radius:15px;
  margin-bottom:15px;
}
.balance{
  font-size:36px;
  font-weight:600;
  margin-top:10px;
}

/* Buttons */
.btn{
  width:100%;
  padding:14px;
  border:none;
  border-radius:12px;
  font-size:16px;
  font-weight:600;
  margin-top:10px;
  cursor:pointer;
  color:#fff;
}
.withdraw{background:#facc15;color:#000;}
.redeem{background:#22c55e;}
.pay{background:#a855f7;}


/* Transactions */
.small{
  opacity:0.7;
  font-size:14px;
}

/* Popup */
.popup{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  display:none;
  align-items:center;
  justify-content:center;
}
.popup-box{
  background:#1e293b;
  padding:20px;
  width:90%;
  max-width:350px;
  border-radius:15px;
}
.popup-box input{
  width:100%;
  padding:12px;
  border-radius:8px;
  border:none;
  margin-top:10px;
}
.popup-actions{
  display:flex;
  justify-content:flex-end;
  gap:10px;
  margin-top:15px;
}
.popup-actions button{
  padding:10px 15px;
  border:none;
  border-radius:8px;
  cursor:pointer;
}

/* Footer */
footer{
  text-align:center;
  padding:20px;
  font-size:13px;
  opacity:.6;
}
/* APP WRAPPER CENTER GAP */
.app{
    width:100%;
    max-width:380px;
    padding:10px;        /* SIDE GAP */
}

/* HEADER BOX FIX */
.header{
    height:70px;
    padding:12px 14px;
    border-radius:16px;
    margin-top:10px;     /* TOP GAP */
    margin-bottom:14px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    background:linear-gradient(135deg,#141a2c,#202531);
}

/* LEFT PART */
.header-left{
    display:flex;
    align-items:center;
    gap:10px;
}

.header img{
    width:50px;
    height:50px;
    border-radius:50%;
}

.header h2{
    font-size:24px;
}

.header p{
    font-size:16px;
    opacity:0.8;
}

/* MENU BUTTON */
.menu-btn{
    font-size:26px;
    cursor:pointer;
    padding:5px 10px;
    border-radius:10px;
    transition:0.2s;
}

.menu-btn:hover{
    background:rgba(255,255,255,0.15);
}
/* ===== Increase Left Right Gap ===== */
.app,
.container,
.main,
.wrapper {
    margin-left: 20px !important;
    margin-right: 20px !important;
}
/* ===== Header Side Gap Fix ===== */
.header,
.top-bar,
.navbar {
    margin-left: 20px !important;
    margin-right: 20px !important;
    border-radius: 14px;
}
/* ===== Header Text Size Increase ===== */
.header h1,
.top-bar h1,
.navbar h1 {
    font-size: 40px !important;
    font-weight: 700;
}

.header p,
.top-bar p,
.navbar p,
.header small {
    font-size: 15px !important;
    letter-spacing: px;
}
.logo-text {
    font-size: 30px !important;
    font-weight: bold;
}
.logo-text {
    font-size: 24px !important;
    font-weight: bold;
}
/* ===== Footer Bottom Fix ===== */
footer {
    position: fixed;
    bottom: 8px;
    left: 0;
    width: 100%;
    text-align: center;
    font-size: 12px;
    color: #cbd5e1;
    z-index: 10;
}
/* ===== Side Menu Drawer ===== */
#menu {
    position: fixed;
    top: 0;
    right: -280px;              /* hidden */
    width: 260px;
    height: 100vh;
    background: linear-gradient(180deg, #212427, #071a33);
    box-shadow: -5px 0 20px rgba(0,0,0,0.6);
    padding: 18px;
    transition: right 0.35s ease;
    z-index: 999;
    border-top-left-radius: 18px;
    border-bottom-left-radius: 18px;
}

/* Menu open state */
#menu.active {
    right: 0;
}

/* MENU title */
.menu-title {
    font-size: 22px;
    font-weight: 800;
    letter-spacing: 2px;
    text-align: center;
    color: #fff;
    margin-bottom: 18px;
    padding-bottom: 10px;
    border-bottom: 1px solid rgba(255,255,255,0.2);
}

/* Menu item */
.menu-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 14px 14px;
    margin-bottom: 10px;
    border-radius: 12px;
    font-size: 15px;
    color: #fff;
    cursor: pointer;
    background: rgba(255,255,255,0.05);
    transition: 0.25s ease;
}

/* Hover effect */
.menu-item:hover {
    background: linear-gradient(90deg, #1e90ff, #00c6ff);
    transform: translateX(-6px);
}

/* Icons look better */
.menu-item span {
    font-size: 18px;
}

/* Hide class remove */
.hidden {
    display: block;
}
.modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 999;
}

.hidden {
  display: none;
}

.modal-box {
  background: #0f172a;
  padding: 20px;
  border-radius: 12px;
  width: 90%;
  max-width: 320px;
  color: white;
  text-align: center;
  pointer-events:auto;
}

.modal-box input {
  width: 100%;
  margin: 8px 0;
  padding: 10px;
  border-radius: 6px;
  border: none;
}

.modal-box button {
  width: 100%;
  margin-top: 10px;
  padding: 10px;
  border-radius: 6px;
  border: none;
  cursor: pointer;
}

.close-btn {
  background: #444;
  color: white;
}

</style>
</head>

<body>

<!-- Header -->
<div class="header">
  <div class="logo">
    <img src="logo.png">
    <div>
      <b>Secure Digital Wallet</b>
      <small>APP REVIEWS WORLD</small>
    </div>
  </div>
  <div class="menu-btn" onclick="toggleMenu()">‚ò∞</div>
</div>
</div>   <!-- header close -->
<div id="overlay" class="menu-overlay" onclick="toggleMenu()"></div>
<!-- Menu Box -->



<div id="menu">
   <h2 class="menu-title">MENU</h2>

   <div class="menu-item" onclick="goProfile()">
   <span>üë§</span> My Profile
</div>
   <div class="menu-item"><span>üí≥</span> Loan Centre</div>
   <div class="menu-item"><span>üìÑ</span> Transaction History</div>
   <div class="menu-item"><span>üí¨</span> Customer Support</div>
   <div class="menu-item"><span>üö™</span> Logout</div>
</div>

<!-- Main -->
<div class="container">

  <!-- Balance -->
  <div class="card">
    <div>Available Balance</div>
    <div id="balance" class="balance">‚Çπ0.00</div>
  </div>

  <!-- Actions -->
  <div class="card">
    <button onclick="openWithdraw()">Withdraw Balance</button>
    <!-- Withdraw Modal -->
<div id="withdrawModal" class="modal hidden">
  <div class="modal-box">
    <h3>üí∏ Withdraw Request</h3>

    <input id="withdrawAmount" type="number" placeholder="Enter Amount">
    <input id="withdrawUpi" type="text" placeholder="Enter UPI ID">

    <button onclick="submitWithdraw()">Submit Request</button>
    <button class="close-btn" onclick="closeWithdraw()">Cancel</button>

    <p id="withdrawMsg"></p>
  </div>
</div>
    <button class="btn redeem" onclick="openRedeem()">Gift Card</button>
    <button class="btn pay">Pay to User</button>
    
  </div>

  <!-- History -->
  <div class="card">
    <b>Transaction History</b><br>
    <span class="small">No transactions yet.</span>
  </div>

</div>

<footer>
¬© App Reviews world 2026. All rights reserved.
</footer>

<!-- Redeem Popup -->
<div class="popup" id="redeemPopup">
  <div class="popup-box">
    <b>Redeem Gift Card</b>
    <input type="text" placeholder="Enter your code">
    <div class="popup-actions">
      <button onclick="closeRedeem()">Cancel</button>
      <button style="background:#22c55e;color:#fff;">Redeem</button>
    </div>
  </div>
</div>

<script>
  firebase.auth().onAuthStateChanged(user => {
  if(user){
    db.collection("users").doc(user.uid).onSnapshot(doc => {
      if(doc.exists){
        const data = doc.data();
        document.getElementById("balance").innerText = "‚Çπ" + (data.balance || 0);
      }
    });
  }
});
  async function submitWithdraw(){
  const amount = Number(document.getElementById("withdrawAmount").value);
  const upi = document.getElementById("withdrawUpi").value.trim();
  const msg = document.getElementById("withdrawMsg");

  if(!amount || amount <= 0 || !upi){
    msg.innerText = "‚ùå Enter valid amount and UPI";
    return;
  }

  if(amount > currentBalance){
    msg.innerText = "‚ùå Insufficient balance";
    return;
  }

  const user = firebase.auth().currentUser;
  if(!user){
    msg.innerText = "‚ùå User not logged in";
    return;
  }

  try{
    // 1Ô∏è‚É£ Create withdraw request
    await db.collection("withdrawRequests").add({
      uid: user.uid,
      email: user.email,
      amount: amount,
      upi: upi,
      status: "pending",
      time: firebase.firestore.FieldValue.serverTimestamp()
    });

    // 2Ô∏è‚É£ Deduct balance
    await db.collection("users").doc(user.uid).update({
      balance: firebase.firestore.FieldValue.increment(-amount)
    });

    msg.innerText = "‚úÖ Withdraw request sent successfully!";
    document.getElementById("withdrawAmount").value = "";
    document.getElementById("withdrawUpi").value = "";

  }catch(err){
    msg.innerText = "‚ùå " + err.message;
  }
}
  let currentBalance = 0;

firebase.auth().onAuthStateChanged(user => {
  if(user){
    db.collection("users").doc(user.uid).onSnapshot(doc => {
      if(doc.exists){
        const data = doc.data();
        currentBalance = data.balance || 0;
        document.getElementById("balance").innerText = "‚Çπ" + currentBalance;
      }
    });
  }
});
  firebase.auth().onAuthStateChanged(user => {
  if(user){
    db.collection("users").doc(user.uid).onSnapshot(doc => {
      if(doc.exists){
        const data = doc.data();
        document.getElementById("balance").innerText = "‚Çπ" + data.balance;
      }
    });
  }
});
  function submitWithdraw(){
  alert("Button Click Working ‚úÖ");
}
  function openWithdraw() {
  document.getElementById("withdrawModal").classList.remove("hidden");
}

function closeWithdraw() {
  document.getElementById("withdrawModal").classList.add("hidden");
}

async function submitWithdraw() {
  const amount = Number(document.getElementById("withdrawAmount").value);
  const upi = document.getElementById("withdrawUpi").value.trim();
  const msg = document.getElementById("withdrawMsg");
  const user = firebase.auth().currentUser;

  if (!amount || !upi) {
    msg.innerText = "‚ùå Fill all fields";
    return;
  }

  try {
    await db.collection("withdrawRequests").add({
      uid: user.uid,
      email: user.email,
      amount: amount,
      upi: upi,
      status: "pending",
      time: firebase.firestore.FieldValue.serverTimestamp()
    });

    msg.innerText = "‚úÖ Request submitted!";
    closeWithdraw();

  } catch (err) {
    msg.innerText = "‚ùå " + err.message;
  }
}
  function goProfile(){
    window.location.href = "profile.html";
}
  document.addEventListener("click", function(e) {
    const menu = document.getElementById("menu");
    const menuBtn = document.querySelector(".menu-btn");

    if (!menu.contains(e.target) && !menuBtn.contains(e.target)) {
        menu.classList.remove("active");
    }
});
  

  function toggleMenu() {
    const menu = document.getElementById("menu");
    menu.classList.toggle("active");
}
function openRedeem(){
  document.getElementById("redeemPopup").style.display="flex";
}
function closeRedeem(){
  document.getElementById("redeemPopup").style.display="none";
}


function goHistory(){
  document.querySelector(".container").scrollIntoView({ behavior: "smooth" });
}

function logout(){
  if(confirm("Are you sure you want to logout?")){
    window.location.href = "index.html";
  }
}
</script>

</body>
</html>